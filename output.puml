@startuml
' Drone Rescue TEC - SysML-lite in PlantUML (structure + requirements)
skinparam classAttributeIconSize 0
hide circle
left to right direction

package "System Context" {
  class DroneRescueTEC <<system>> {
    mission = "Deliver confirmed human coordinate <=15min"
    environment = "Alpine canopy, fog/dusk, multipath"
    ops = "Manual override and safe states always available"
  }

  class DistressInput <<external>> {
    channels: UWB tag (preferred)
    GNSS/LoRa coordinates
    manual report via phone/radio
  }

  class RescueTeam <<external>> {
    actions: dispatch, medical prep, extraction
  }
}

package "Ground Segment" {
  class GroundControlStation <<subsystem>> {
    UI: distress intake, polygon draw/edit
    Overlays: geofence, live anchors/VTOL, media
    Outputs: dispatch package to rescue team
  }

  class MissionAutomation <<subsystem>> {
    Plans: launch, anchor RTK points, RTL/hover fail-safe
    Guards: endurance, weather, geofence, ADS-B/TCAS
    Interfaces: operator overrides at any time
  }

  class LocalizationEngine <<subsystem>> {
    Priority: UWB TDoA for sub-meter fix
    Fallback: AoA/RSSI fusion to <=10 m
    Outputs: coordinate, covariance, confidence stream
  }

  class CommunicationsMesh <<subsystem>> {
    Links: UWB, Wi-Fi/mesh, LoRa beacon, optional LTE
    Behaviors: multi-hop backhaul, QoS for telemetry/media
    Resilience: geofence-aware reroute; edge-first (no cloud dep)
  }
}

package "VTOL Relay Drone" {
  class VTOL_Relay <<subsystem>> {
    role = "High-altitude mesh relay + AoA scout"
    behavior = "Launch first; canopy-clear loiter"
  }
  class VTOL_Airframe <<component>> {
    type = "Fixed-wing VTOL hybrid"
    envelope = "Canopy-clear, endurance-optimized"
  }
  class VTOL_PropulsionPower <<component>> {
    lift_cruise = "VTOL lift + cruise propulsors"
    power = "Li-ion pack; power/thermal monitor"
  }
  class VTOL_NavigationAvionics <<component>> {
    sensors = "GNSS/RTK, IMU, baro, mag"
    functions = "Waypoint hold, geofence, ADS-B awareness"
  }
  class VTOL_CommsSDR <<component>> {
    radios = "Mesh, LoRa beacon, optional LTE"
    SDR = "Wideband AoA sweep, bearing estimate"
    antennas = "Directional + omni"
  }
  class VTOL_EdgeCompute <<component>> {
    tasks = "AoA processing, link management"
  }
  class VTOL_Safety <<component>> {
    modes = "Manual override, hover/RTL, lost-link safe"
  }
}

package "Anchor Drone (x3 typical)" {
  class Anchor_Drone <<subsystem>> {
    role = "RTK anchor, TDoA node, confirmer, optional payload drop"
    behavior = "Auto-fly to anchor points; hover; controlled descent"
  }
  class Anchor_Airframe <<component>> {
    type = "Multirotor; precision hover"
    envelope = "Forest/fog/dusk tolerant"
  }
  class Anchor_PropulsionPower <<component>> {
    propulsion = "Multi-rotor lift"
    power = "Smart battery; power guard"
  }
  class Anchor_NavigationAvionics <<component>> {
    sensors = "GNSS/RTK, IMU, baro"
    functions = "Geofence, PTP/RTK time sync, micro-positioning"
  }
  class Anchor_CommsSensors <<component>> {
    radios = "UWB node, mesh link, LoRa beacon"
    SDR = "RSSI/AoA support"
    payload = "Thermal + RGB gimbal"
  }
  class Anchor_EdgeCompute <<component>> {
    tasks = "TDoA solver, AoA/RSSI fusion, CNN detection"
  }
  class Anchor_SafetyPayload <<component>> {
    modes = "Manual override, hover/RTL, link-loss safe"
    payload = "Optional dropper; release interlocks"
  }
}

' Composition relationships (structure)
DroneRescueTEC o-- GroundControlStation
DroneRescueTEC o-- MissionAutomation
DroneRescueTEC o-- LocalizationEngine
DroneRescueTEC o-- CommunicationsMesh
DroneRescueTEC o-- VTOL_Relay
DroneRescueTEC o-- "3" Anchor_Drone
DroneRescueTEC .. RescueTeam : dispatch coordinates
DistressInput ..> GroundControlStation : distress data
GroundControlStation --> MissionAutomation : missions/overrides
MissionAutomation --> VTOL_Relay : launch/waypoints
MissionAutomation --> Anchor_Drone : anchor plan
CommunicationsMesh <.. VTOL_CommsSDR
CommunicationsMesh <.. Anchor_CommsSensors
LocalizationEngine <- Anchor_EdgeCompute : TDoA/AoA/RSSI
LocalizationEngine <- VTOL_CommsSDR : AoA bearing
GroundControlStation <- LocalizationEngine : coords/confidence

' VTOL composition
VTOL_Relay o-- VTOL_Airframe
VTOL_Relay o-- VTOL_PropulsionPower
VTOL_Relay o-- VTOL_NavigationAvionics
VTOL_Relay o-- VTOL_CommsSDR
VTOL_Relay o-- VTOL_EdgeCompute
VTOL_Relay o-- VTOL_Safety

' Anchor composition
Anchor_Drone o-- Anchor_Airframe
Anchor_Drone o-- Anchor_PropulsionPower
Anchor_Drone o-- Anchor_NavigationAvionics
Anchor_Drone o-- Anchor_CommsSensors
Anchor_Drone o-- Anchor_EdgeCompute
Anchor_Drone o-- Anchor_SafetyPayload

package "Requirements" {
  class F01_Distress_Intake <<requirement>> {
    id = "F-01"
    text = "Accept distress inputs and define search polygon"
  }
  class F02_Launch_Search <<requirement>> {
    id = "F-02"
    text = "Launch drone(s) to spot injured hiker"
  }
  class F03_Localize_Confirm <<requirement>> {
    id = "F-03"
    text = "Localize, refine, and confirm with updates"
  }

  class R01_15min <<requirement>> {
    id = "R-01"
    text = "Confirmed coordinate within 15 min; incremental updates"
  }
  class R02_SubMeter <<requirement>> {
    id = "R-02"
    text = "Sub-meter (0.1â€“2 m) accuracy for spotting"
  }
  class R04_Alpine_Edge <<requirement>> {
    id = "R-04"
    text = "Operate in alpine canopy/fog with edge processing"
  }
  class R05_Safety_Override <<requirement>> {
    id = "R-05"
    text = "Manual override and safe states (hover/RTL) anytime"
  }
  class R06_Cost_Efficiency <<requirement>> {
    id = "R-06"
    text = "Prefer COTS, efficient compute/power, quiet"
  }
  class R07_Payload_Option <<requirement>> {
    id = "R-07"
    text = "Optional payload drop/hover without comms loss"
  }
}

' Requirement satisfaction mapping
GroundControlStation ..> F01_Distress_Intake : satisfies
MissionAutomation ..> F02_Launch_Search : satisfies
VTOL_Relay ..> F02_Launch_Search : satisfies
Anchor_Drone ..> F02_Launch_Search : satisfies
LocalizationEngine ..> F03_Localize_Confirm : satisfies
Anchor_EdgeCompute ..> F03_Localize_Confirm : supports
GroundControlStation ..> F03_Localize_Confirm : supports

DroneRescueTEC ..> R01_15min : satisfies
LocalizationEngine ..> R02_SubMeter : satisfies
Anchor_EdgeCompute ..> R02_SubMeter : supports
Anchor_Drone ..> R04_Alpine_Edge : satisfies
VTOL_Relay ..> R04_Alpine_Edge : supports
VTOL_Safety ..> R05_Safety_Override : satisfies
Anchor_SafetyPayload ..> R05_Safety_Override : satisfies
DroneRescueTEC ..> R06_Cost_Efficiency : satisfies
Anchor_SafetyPayload ..> R07_Payload_Option : satisfies
VTOL_Safety ..> R07_Payload_Option : supports

note "Assumptions: UWB tag preferred; LTE only if permitted; 3 anchors typical for TDoA; cloud not required." as N1
DroneRescueTEC .. N1
@enduml


@startuml
title Operational Scenario Activity (15 min target)
start
:Distress intake at GCS (UWB preferred / GNSS / LoRa / manual);
:Operator draws/edits search polygon; geofence loaded;
:MissionAutomation checks endurance, weather, RTK corrections;
:Launch VTOL relay; climb to canopy-clear altitude;
:Establish mesh backhaul; SDR AoA sweep for bearing;
fork
  :Plan RTK anchor points inside polygon;
  :Launch 3 anchor drones; geofence, hover, time-sync (PTP/RTK);
end fork
if (UWB pulses detected?) then (Yes)
  :Anchors compute TDoA for sub-meter fix;
else (No)
  :Fuse VTOL AoA with anchor RSSI/AoA (<=~10 m);
endif
:Nearest anchor descends slightly; runs thermal/RGB CNN;
:Send snapshots + refined coord/confidence to GCS overlays;
:Operator may manual-override any drone at any time;
:Dispatch confirmed coordinate to rescue team;
:Option: maintain relay hover / payload drop / RTL;
stop
@enduml
